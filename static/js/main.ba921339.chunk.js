(this["webpackJsonpeclipsis-skin-preview"]=this["webpackJsonpeclipsis-skin-preview"]||[]).push([[0],[,,,,,,,,function(e,t,n){e.exports=n.p+"static/media/Settings.982ae196.svg"},,,,,,function(e,t,n){e.exports=n.p+"static/media/Upload.90ba7a4b.svg"},function(e,t,n){e.exports=n.p+"static/media/Code.3354fae2.svg"},function(e,t,n){e.exports=n.p+"static/media/Switch.519a6516.svg"},function(e,t,n){e.exports=n.p+"static/media/Close.35eee04d.svg"},,function(e,t,n){e.exports=n(30)},,,,,function(e,t,n){},,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var a=n(1),o=n.n(a),r=n(12),i=n.n(r),c=(n(24),n(6)),s=n.n(c),l=n(10),u=n(2),d=n(5),f=n(4),m=n(3),h=n(0),g=n(13),p=n(18),v=(n(26),n(14)),w=n.n(v),b=n(15),S=n.n(b),k=n(16),C=n.n(k),E=n(8),y=n.n(E),x=n(9),G=(n(27),n(17)),R=n.n(G),N=function(e){Object(f.a)(n,e);var t=Object(m.a)(n);function n(e){var a;for(var o in Object(u.a)(this,n),(a=t.call(this,e)).settings={movementSmoothing:!0,movementSmoothingFactor:.05,panningLocked:!0,showGrid:!0,oneTabPolicy:!1,autoCloseGunSelector:!1,cameraZoomRate:1,backgroundColor:"3A3A3A"},a.updateSetting=function(e,t){"_"!==e.charAt(0)&&(a.settings[e]=t,a.forceUpdate(),a.props.eventBind(e,a.settings[e]),localStorage.setItem("settings",JSON.stringify(a.settings)))},Object.assign(a.settings,JSON.parse(localStorage.getItem("settings")||"{}")),a.settings){if("_"===o.charAt(0))return Object(x.a)(a);a.props.eventBind(o,a.settings[o])}return a.settings._buildTime=String("8/1/2020, 11:31:20 PM"),a}return Object(d.a)(n,[{key:"prettyPrintVariable",value:function(e){var t=e.replace(/([A-Z])/g," $1").replace(/_/g,"").trim();return t.charAt(0).toUpperCase()+t.slice(1)}}]),Object(d.a)(n,[{key:"render",value:function(){var e=this,t=[],n=function(n){var a=e.settings[n],r=o.a.createElement(o.a.Fragment,null);if("_"===n.charAt(0))r=o.a.createElement("p",null,a);else switch(typeof a){case"boolean":r=o.a.createElement("div",{onClick:function(){return e.updateSetting(n,!e.settings[n])},className:"modify boolean ".concat(a?"active":"")},o.a.createElement("div",{className:"small-box"}));break;case"number":r=o.a.createElement("input",{type:"number",autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:"false",onChange:function(t){return e.updateSetting(n,Number(t.target.value))},value:a,className:"modify"});break;case"string":r=o.a.createElement("input",{type:"text",autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:"false",onChange:function(t){return e.updateSetting(n,t.target.value)},value:a,className:"modify"});break;default:console.warn("Input type ".concat(typeof a," for field ").concat(n," is not supported."))}t.push(o.a.createElement("div",{className:"setting-field",key:n},o.a.createElement("p",null,e.prettyPrintVariable(n)),r))};for(var a in this.settings)n(a);return o.a.createElement("div",{className:"settings-container ".concat(this.props.hidden?"hidden":"")},o.a.createElement("div",{className:"settings"},o.a.createElement("div",{className:"settings-header"},o.a.createElement("div",{className:"img-container"},o.a.createElement("img",{src:y.a,draggable:!1,alt:""})),o.a.createElement("p",null,"Settings"),o.a.createElement("div",{className:"close-container img-container",onClick:this.props.closeSettings},o.a.createElement("img",{src:R.a,draggable:!1,alt:"Close"}))),o.a.createElement("div",{className:"settings-content"},t)))}}]),n}(o.a.PureComponent),O=(n(28),{All:"All Available Guns",Assault:"Assault Rifle",GrenadeLauncher:"Grenade Launcher",LaserDrill:"Laser Drill",Minigun:"Minigun",NapalmDestroyer:"Napalm Destroyer",Pistol:"Pistol",Portafab:"Portafab",RocketLauncher:"Rocket Launcher",SatchelCharge:"Satchel Charge",Scanner:"Scanner",Shotgun:"Shotgun",SMG:"Sub-Machine Gun",SniperRifle:"Sniper Rifle"}),j=function(e){Object(f.a)(n,e);var t=Object(m.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"render",value:function(){for(var e=this,t=[],n=function(){var n=r[a];t.push(o.a.createElement("div",{className:"gun-field",key:n,onClick:function(){return e.props.selectGun(n)}},o.a.createElement("p",null,O[n])))},a=0,r=Object.keys(O);a<r.length;a++)n();return o.a.createElement("div",{className:"gun-selector"},t)}}]),n}(o.a.PureComponent),P=(n(29),function(e){Object(f.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(u.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={shown:!1,left:0,top:0},e.contextRef=o.a.createRef(),e.cachedReference="",e.cachedEntries=[],e.leftClick=function(t){t.preventDefault(),e.setState({shown:!1}),document.removeEventListener("click",e.leftClick)},e.rightClick=function(t){(t.preventDefault(),e.props.entries.length<1)?e.state.shown&&e.setState({shown:!1}):e.contextRef.current&&(e.cachedReference=e.props.reference,e.cachedEntries=e.props.entries,e.setState({shown:!0,left:t.clientX,top:t.clientY},(function(){document.addEventListener("click",e.leftClick)})))},e.render=function(){var t=e.cachedEntries.map((function(e){return o.a.createElement("p",{className:"entry",key:e.name,onClick:e.callback},e.name)}));return o.a.createElement("div",{className:"context-menu ".concat(e.state.shown?"":"hidden"),ref:e.contextRef,style:{left:e.state.left+10,top:e.state.top}},o.a.createElement("p",{className:"header"},e.cachedReference),t)},e}return Object(d.a)(n,[{key:"componentDidMount",value:function(){document.addEventListener("contextmenu",this.rightClick)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("contextmenu",this.rightClick)}}]),n}(o.a.PureComponent)),M="https://github.com/xethlyx/eclipsis-skin-preview",A=function(e){Object(f.a)(n,e);var t=Object(m.a)(n);function n(e){var a;Object(u.a)(this,n),(a=t.call(this,e)).state={userUploaded:!1,settingsShown:!1,gunSelectorShown:!1,contextName:"",contextMenu:[]},a.buttonContextMap={upload:[{name:"Reset Skin",callback:function(){return a.loadDefaultSkin()}}],change:[{name:"Refresh Gun Objects",callback:function(){return a.cacheGuns()}}],settings:[{name:"Reset Settings",callback:function(){localStorage.removeItem("settings"),window.location.reload(!1)}}],source:[{name:"Open link in current tab",callback:function(){return window.location.href=M}},{name:"Open link in new tab",callback:function(){return window.open(M,"_BLANK")}},{name:"Copy link to clipboard",callback:function(){return navigator.clipboard.writeText(M)}}]},a.scene=new h.t,a.camera=new h.p(75,window.innerWidth/window.innerHeight,.1,1e3),a.renderer=new h.z({antialias:!0}),a.controls=new g.a(a.camera,a.renderer.domElement),a.currentSkin="",a.currentGun="Assault",a.lastGunId=null,a.oneTabPolicy=!1,a.autoCloseGunSelector=!1,a.gunMeshCache={},a.loadDefaultSkin=function(){a.toDataUrl("GunTexture.png").then((function(e){a.currentSkin=e,a.loadWithTexture(a.currentSkin)}))},a.cacheGuns=function(){Object.keys(O).forEach(function(){var e=Object(l.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(new p.a).load("".concat(t,".obj"),(function(e){a.gunMeshCache[t]=e}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},a.loadWithTexture=function(){var e=Object(l.a)(s.a.mark((function e(t){var n,o,r,i,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.gunMeshCache[a.currentGun]){e.next=4;break}return console.warn("Gun ".concat(a.currentGun," not found! Is it still loading?")),e.abrupt("return");case 4:(o=document.createElement("img")).src=t,r=new h.w(o),o.addEventListener("load",(function(e){r.needsUpdate=!0})),i=new h.m({color:16777215,map:r,flatShading:!0}),n.traverse((function(e){e instanceof h.l&&(e.material=i)})),a.lastGunId&&(c=a.scene.getObjectById(a.lastGunId))&&a.scene.remove(c),a.lastGunId=n.id,a.scene.add(n);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.mountRef=o.a.createRef(),a.uploadRef=o.a.createRef(),a.uploadPassthrough=function(){var e;null===(e=a.uploadRef.current)||void 0===e||e.click()},a.fileUploaded=function(e){if(e.target.files&&e.target.files[0]){var t=new FileReader;t.addEventListener("load",(function(e){var t;e.target&&(a.currentSkin=(null===(t=e.target.result)||void 0===t?void 0:t.toString())||"",a.setState({userUploaded:!0}),a.loadWithTexture(a.currentSkin))})),t.readAsDataURL(e.target.files[0])}},a.toggleSettings=function(){a.setState({gunSelectorShown:!a.oneTabPolicy&&a.state.gunSelectorShown,settingsShown:!a.state.settingsShown})},a.attemptAutoCloseGunSelector=function(){a.autoCloseGunSelector&&a.setState({gunSelectorShown:!1})},a.toggleGunSelector=function(){a.setState({settingsShown:!a.oneTabPolicy&&a.state.settingsShown,gunSelectorShown:!a.state.gunSelectorShown})},a.settingChanged=function(e,t){switch(console.log("Settings ".concat(e," was changed to ").concat(t)),e){case"movementSmoothing":a.controls.enableDamping=t;break;case"movementSmoothingFactor":a.controls.dampingFactor=t;break;case"panningLocked":a.controls.enablePan=!t;break;case"cameraZoomRate":a.controls.zoomSpeed=t;break;case"showGrid":var n=a.scene.getObjectByName("Grid");n&&(n.visible=t);break;case"oneTabPolicy":a.oneTabPolicy=t;break;case"autoCloseGunSelector":a.autoCloseGunSelector=t;break;case"backgroundColor":a.scene.background=new h.c(Number.parseInt(t,16));break;default:console.warn("Property ".concat(e," was changed, but no handler was attached!"))}},a.selectGun=function(e){a.currentGun=e,a.attemptAutoCloseGunSelector(),a.loadWithTexture(a.currentSkin),a.forceUpdate()},a.resetContext=function(){a.setState({contextMenu:[]})},a.setContext=function(e){a.setState({contextName:e.toUpperCase(),contextMenu:a.buttonContextMap[e]})},a.scene.background=new h.c(3815994),a.camera.position.set(3,2,2),a.renderer.setPixelRatio(window.devicePixelRatio),a.renderer.setSize(window.innerWidth,window.innerHeight),a.controls.enableDamping=!0,a.controls.zoomSpeed=1,a.controls.enablePan=!1,a.controls.minDistance=1,a.controls.maxDistance=100,window.addEventListener("resize",(function(e){a.camera.aspect=window.innerWidth/window.innerHeight,a.camera.updateProjectionMatrix(),a.renderer.setPixelRatio(window.devicePixelRatio),a.renderer.setSize(window.innerWidth,window.innerHeight)})),a.cacheGuns();return function e(){requestAnimationFrame(e),a.renderer.render(a.scene,a.camera),a.controls.update()}(),a}return Object(d.a)(n,[{key:"componentDidMount",value:function(){if(!this.mountRef.current)throw new Error("Mount point not found");this.mountRef.current.appendChild(this.renderer.domElement);var e=new h.f(100,100,new h.c(16777215));e.name="Grid",e.position.set(0,-.75,0),this.scene.add(e),this.loadDefaultSkin()}}]),Object(d.a)(n,[{key:"toDataUrl",value:function(e){return new Promise((function(t){var n=new XMLHttpRequest;n.addEventListener("load",(function(e){var a=new FileReader;a.onloadend=function(){var e;t(null===(e=a.result)||void 0===e?void 0:e.toString())},a.readAsDataURL(n.response)})),n.open("GET",e),n.responseType="blob",n.send()}))}},{key:"render",value:function(){var e=this;return o.a.createElement(o.a.Fragment,null,o.a.createElement(P,{reference:this.state.contextName,entries:this.state.contextMenu}),o.a.createElement("input",{type:"file",className:"hidden",ref:this.uploadRef,onChange:this.fileUploaded}),o.a.createElement("div",{className:"app",ref:this.mountRef},o.a.createElement("div",{className:"sidebar"},o.a.createElement("button",{title:"Upload Skin",onMouseLeave:this.resetContext,onMouseEnter:function(){return e.setContext("upload")},onClick:this.uploadPassthrough},o.a.createElement("img",{alt:"Upload Skin",draggable:!1,src:w.a})),o.a.createElement("button",{title:"Change Gun",onMouseLeave:this.resetContext,onMouseEnter:function(){return e.setContext("change")},onClick:this.toggleGunSelector},o.a.createElement("img",{alt:"Change Gun",draggable:!1,src:C.a})),o.a.createElement("button",{title:"Settings",onMouseLeave:this.resetContext,onMouseEnter:function(){return e.setContext("settings")},onClick:this.toggleSettings},o.a.createElement("img",{alt:"Settings",draggable:!1,src:y.a})),o.a.createElement("button",{title:"View Source",onMouseLeave:this.resetContext,onMouseEnter:function(){return e.setContext("source")},onClick:function(){return window.location.href=M}},o.a.createElement("img",{alt:"View Source",draggable:!1,src:S.a}))),!this.state.gunSelectorShown||o.a.createElement(j,{selectGun:this.selectGun}),o.a.createElement(N,{closeSettings:this.toggleSettings,eventBind:this.settingChanged,hidden:!this.state.settingsShown}),o.a.createElement("div",{className:"info-indicator"},o.a.createElement("p",null,this.state.userUploaded?"User Content":"System Default"),o.a.createElement("p",null,O[this.currentGun]))))}}]),n}(o.a.PureComponent),L=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function U(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}i.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(A,null)),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/eclipsis-skin-preview",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/eclipsis-skin-preview","/service-worker.js");L?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):U(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):U(t,e)}))}}()}],[[19,1,2]]]);
//# sourceMappingURL=main.ba921339.chunk.js.map